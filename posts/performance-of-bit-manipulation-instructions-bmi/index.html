<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Performance of Bit Manipulation Instructions (BMI) - Tearth's homepage</title><script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script><meta name=description content="Small discussion about Bit Manipulation Instructions (BMI) set, with a comparison of assembly code and performance between typical computations and intrinsic functions."><meta property="og:title" content="Performance of Bit Manipulation Instructions (BMI)"><meta property="og:description" content="Small discussion about Bit Manipulation Instructions (BMI) set, with a comparison of assembly code and performance between typical computations and intrinsic functions."><meta property="og:type" content="article"><meta property="og:url" content="https://tearth.dev/posts/performance-of-bit-manipulation-instructions-bmi/"><meta property="og:image" content="https://tearth.dev/img/card.jpg"><meta property="article:published_time" content="2024-05-08T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-08T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tearth.dev/img/card.jpg"><meta name=twitter:title content="Performance of Bit Manipulation Instructions (BMI)"><meta name=twitter:description content="Small discussion about Bit Manipulation Instructions (BMI) set, with a comparison of assembly code and performance between typical computations and intrinsic functions."><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/bundle.min.css><link rel="shortcut icon" href=/favicon.ico><script defer src=https://b.tearth.dev/script.js data-website-id=0f32476c-b2f9-4123-8feb-771a0e3f5463></script></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Tearth's homepage" rel=home><div class=logo__title>Tearth's homepage</div><div class=logo__tagline>Loosely updated site about everything I enjoy</div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Performance of Bit Manipulation Instructions (BMI)</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2024-05-08T00:00:00Z>2024-05-08</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/performance-comparisons/ rel=category>Performance comparisons</a></span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#theory>Theory</a></li><li><a href=#implementation>Implementation</a><ul><li></li></ul></li><li><a href=#comparison>Comparison</a></li><li><a href=#a-few-words-about-c>A few words about C#</a></li></ul></nav></div></div><div class="content post__content clearfix"><p><strong>Bit Manipulation Instructions</strong> (BMI) is an interesting extension for the x86-64 architecture, introduced by Intel in Haswell processors (early 2010s). Its main purpose is, as the name suggests, increasing the speed of the most common bit operations by replacing manual calculation with dedicated instructions (which means hardware support). This article will focus on the performance of three example instructions: <a href=https://www.felixcloutier.com/x86/BLSI>BLSI</a> (reads the lowest bit), <a href=https://www.felixcloutier.com/x86/BLSR>BLSR</a> (resets the lowest bit) and <a href=https://www.felixcloutier.com/x86/TZCNT>TZCNT</a> (counts the number of trailing non-set bits).</p><h2 id=theory>Theory</h2><p>The first time I met with Bit Manipulation Instructions was while developing a chess engine <a href=https://github.com/Tearth/Proxima-b-2.0>Proxima b 2.0</a> for my thesis. It is important to know, that nearly every modern engine represents the chessboard in memory as <a href=https://www.chessprogramming.org/Bitboards>bitboards</a> - a collection of unsigned 64-bit variables, where every bit represents one field. Thanks to it, a lot of things (like generating moves or checking which pieces are currently attacked) can be done fast using bit operations. The correct implementation is crucial for whole engine performance, and that&rsquo;s where hardware support for more complex expressions can be really useful. BMI isn&rsquo;t one solid pack of instructions - there are two main sets (which are identified separately by <a href=https://www.felixcloutier.com/x86/CPUID>CPUID</a> instruction):</p><ul><li><strong>BMI1</strong> contains 6 new instructions to resetting, extracting, counting and comparing</li></ul><table><thead><tr><th>Instruction name</th><th>Description</th></tr></thead><tbody><tr><td><a href=https://www.felixcloutier.com/x86/ANDN>ANDN</a></td><td>Performs logical AND with negated X and Y (<code>~x & y</code>)</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/BEXTR>BEXTR</a></td><td>Reads n bits starting from the specified index</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/BLSI>BLSI</a></td><td>Reads the lowest bit (<code>x & ~x</code>)</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/BLSMSK>BLSMSK</a></td><td>Creates mask for all bits up to the lowest bit (<code>x ^ (x - 1)</code>)</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/BLSR>BLSR</a></td><td>Resets the lowest bit (<code>x & (x - 1)</code>)</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/TZCNT>TZCNT</a></td><td>Calculates the number of trailing non-set bits</td></tr></tbody></table><ul><li><strong>BMI2</strong> contains 8 new instructions mainly for shifting, rotating and parallel operations</li></ul><table><thead><tr><th>Instruction name</th><th>Description</th></tr></thead><tbody><tr><td><a href=https://www.felixcloutier.com/x86/BZHI>BZHI</a></td><td>Zeros all bits from the specified index</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/MULX>MULX</a></td><td>Performs unsigned multiplication without affecting flags</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/PDEP>PDEP</a></td><td>Stores bits using the mask</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/PEXT>PEXT</a></td><td>Extracts bits using the mask</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/RORX>RORX</a></td><td>Rotates logical right without affecting flags</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/SARX:SHLX:SHRX>SARX</a></td><td>Performs arithmetic right shift without affecting flags</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/SARX:SHLX:SHRX>SHRX</a></td><td>Performs logical right shift without affecting flags</td></tr><tr><td><a href=https://www.felixcloutier.com/x86/SARX:SHLX:SHRX>SHLC</a></td><td>Performs logical left shift without affecting flags</td></tr></tbody></table><p>What&rsquo;s more, AMD created its own sets:</p><ul><li><strong>ABM</strong> (Advanced Bit Manipulation) with two instructions: <a href=https://www.felixcloutier.com/x86/POPCNT>POPCNT</a> (calculates the number of set bits) and <a href=https://www.felixcloutier.com/x86/LZCNT>LZCNT</a> (calculates the number of leading non-set bits).</li><li><strong>TBM</strong> (Trailing Bit Manipulation) - a set of 10 instructions whose goal was to refill the original BMI set. You can read more about them in the <a href=https://www.amd.com/system/files/TechDocs/24594.pdf>AMD documentation</a>.</li></ul><p>As you can see, there are many ways to operate on bits using hardware support. In the next chapter, we will focus on the performance of three instructions: <a href=https://www.felixcloutier.com/x86/BLSI>BLSI</a>, <a href=https://www.felixcloutier.com/x86/BLSR>BLSR</a>, <a href=https://www.felixcloutier.com/x86/TZCNT>TZCNT</a>. First, we will write a program that performs operations using traditional mathematical formulas and then compares their performance with BMI instructions described above.</p><h2 id=implementation>Implementation</h2><p>Each test will be implemented in Rust and benchmarked by <a href=https://github.com/bheisler/criterion.rs>criterion.rs</a> framework.</p><h4 id=blsi>BLSI</h4><p>At first, we will test <a href=https://www.felixcloutier.com/x86/BLSI>BLSI</a> instruction, which reads the lowest set bit and returns it. The equivalent formula for this operation is <code>x & -x</code> - ANDing variable with its negation, which works thanks to U2 (two&rsquo;s complement) system, where negating a number is just an inversion of all bits, and then adding 1. Let&rsquo;s see at the example for 8-bit number 108:</p><pre><code>    x = 01101100
   -x = 10010100

        01101100
    AND 10010100
    ------------
        00000100
</code></pre><p>Having this knowledge, let&rsquo;s see at the example implementation in Rust.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>black_box</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_group</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_main</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>Criterion</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>benchmark</span><span class=p>(</span><span class=n>criterion</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>Criterion</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>criterion</span><span class=p>.</span><span class=n>bench_function</span><span class=p>(</span><span class=s>&#34;get_lsb&#34;</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>bencher</span><span class=o>|</span><span class=w> </span><span class=n>bencher</span><span class=p>.</span><span class=n>iter</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>get_lsb</span><span class=p>(</span><span class=n>black_box</span><span class=p>(</span><span class=mi>45631345</span><span class=p>))));</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>get_lsb</span><span class=p>(</span><span class=n>x</span>: <span class=kt>u64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u64</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>.</span><span class=n>wrapping_neg</span><span class=p>()</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>criterion_group</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>,</span><span class=w> </span><span class=n>benchmark</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>criterion_main</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>);</span><span class=w>
</span></code></pre></td></tr></table></div></div><p>Assembly code generated by the compiler is straightforward - we store <code>x</code> in <code>rax</code> register, negate it and perform logical AND with <code>x</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-nasm data-lang=nasm><span class=nf>mov</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>neg</span> <span class=nb>rax</span>
<span class=nf>and</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>ret</span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s check what we will see after using <a href=https://www.felixcloutier.com/x86/BLSI>BLSI</a> instruction. To enable BMI1 instruction set we have to set environmental variable RUSTFLAGS (<code>RUSTFLAGS = "-C target-feature=+bmi1</code>) and recompile project - Rust compiler should detect and optimize the formula to <code>blsi</code> without any additional action.</p><p>Now the assembly code. As expected, a few instructions has been replaced by single <code>blsi</code> call with <code>rcx</code> as the source, and <code>rax</code> as the destination register.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-nasm data-lang=nasm><span class=nf>blsi</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>ret</span></code></pre></td></tr></table></div></div><p>Benchmark results:</p><table><thead><tr><th></th><th align=left>Lower bound</th><th align=left>Estimate</th><th align=left>Upper bound</th></tr></thead><tbody><tr><td>Manual</td><td align=left>356.28 ps</td><td align=left><strong>356.69 ps</strong></td><td align=left>357.16 ps</td></tr><tr><td>BMI1</td><td align=left>356.22 ps</td><td align=left><strong>356.97 ps</strong></td><td align=left>357.87 ps</td></tr></tbody></table><h4 id=blsr>BLSR</h4><p><a href=https://www.felixcloutier.com/x86/BLSR>BLSR</a> instruction resets the lowest set bit and returns the new value. The equivalent formula for this operation is <code>x & (x - 1)</code> - ANDing variable with its copy decreased by 1. Let&rsquo;s see at the example for 8-bit number 108 (similar as in previous chapter):</p><pre><code>    x = 01101100
x - 1 = 01101011

        01101100
    AND 01101011
    ------------
        01101000
</code></pre><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>black_box</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_group</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_main</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>Criterion</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>benchmark</span><span class=p>(</span><span class=n>criterion</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>Criterion</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>criterion</span><span class=p>.</span><span class=n>bench_function</span><span class=p>(</span><span class=s>&#34;pop_lsb&#34;</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>bencher</span><span class=o>|</span><span class=w> </span><span class=n>bencher</span><span class=p>.</span><span class=n>iter</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>get_lsb</span><span class=p>(</span><span class=n>black_box</span><span class=p>(</span><span class=mi>45631345</span><span class=p>))));</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>pop_lsb</span><span class=p>(</span><span class=n>x</span>: <span class=kt>u64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u64</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>criterion_group</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>,</span><span class=w> </span><span class=n>benchmark</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>criterion_main</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>);</span><span class=w>
</span></code></pre></td></tr></table></div></div><p>Assembly code generated by the compiler is also pretty simple - <code>lea</code> instruction decrements <code>rcx</code> register (where the iterator is stored), and stores result in the <code>rax</code> register. Both <code>rax</code> and <code>rcx</code> are then ANDed and the result is stored to the <code>rax</code> register.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-nasm data-lang=nasm><span class=nf>lea</span> <span class=nb>rax</span><span class=p>,</span> <span class=p>[</span><span class=nb>rcx</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
<span class=nf>and</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>ret</span></code></pre></td></tr></table></div></div><p>With BMI1 enabled, both instructions are merged into single <code>blsi</code> with the result stored in the <code>rax</code> register.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-nasm data-lang=nasm><span class=nf>blsi</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>ret</span></code></pre></td></tr></table></div></div><p>Benchmark results:</p><table><thead><tr><th></th><th align=left>Lower bound</th><th align=left>Estimate</th><th align=left>Upper bound</th></tr></thead><tbody><tr><td>Manual</td><td align=left>356.12 ps</td><td align=left><strong>357.31 ps</strong></td><td align=left>359.10 ps</td></tr><tr><td>BMI1</td><td align=left>356.65 ps</td><td align=left><strong>357.58 ps</strong></td><td align=left>358.92 ps</td></tr></tbody></table><h4 id=tzcnt>TZCNT</h4><p>The last tested instruction, <a href=https://www.felixcloutier.com/x86/TZCNT>TZCNT</a>, counts trailing non-set bits. The algorithm is based on <a href=https://www.chessprogramming.org/BitScan#De_Bruijn_Multiplication>De Bruijn multiplication</a> which is considered as one of the fastest alternative to <code>tzcnt</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>black_box</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_group</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_main</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>Criterion</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>benchmark</span><span class=p>(</span><span class=n>criterion</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>Criterion</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>criterion</span><span class=p>.</span><span class=n>bench_function</span><span class=p>(</span><span class=s>&#34;bit_scan&#34;</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>bencher</span><span class=o>|</span><span class=w> </span><span class=n>bencher</span><span class=p>.</span><span class=n>iter</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>bit_scan</span><span class=p>(</span><span class=n>black_box</span><span class=p>(</span><span class=mi>45631345</span><span class=p>))));</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>bit_scan</span><span class=p>(</span><span class=n>x</span>: <span class=kt>u64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u64</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=cp>#[rustfmt::skip]</span><span class=w>
</span><span class=w>    </span><span class=k>const</span><span class=w> </span><span class=n>INDEX64</span>: <span class=p>[</span><span class=kt>u32</span><span class=p>;</span><span class=w> </span><span class=mi>64</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=w>
</span><span class=w>        </span><span class=mi>0</span><span class=p>,</span><span class=w>  </span><span class=mi>1</span><span class=p>,</span><span class=w>  </span><span class=mi>48</span><span class=p>,</span><span class=w>  </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>57</span><span class=p>,</span><span class=w> </span><span class=mi>49</span><span class=p>,</span><span class=w> </span><span class=mi>28</span><span class=p>,</span><span class=w>  </span><span class=mi>3</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>61</span><span class=p>,</span><span class=w> </span><span class=mi>58</span><span class=p>,</span><span class=w> </span><span class=mi>50</span><span class=p>,</span><span class=w> </span><span class=mi>42</span><span class=p>,</span><span class=w> </span><span class=mi>38</span><span class=p>,</span><span class=w> </span><span class=mi>29</span><span class=p>,</span><span class=w> </span><span class=mi>17</span><span class=p>,</span><span class=w>  </span><span class=mi>4</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>62</span><span class=p>,</span><span class=w> </span><span class=mi>55</span><span class=p>,</span><span class=w> </span><span class=mi>59</span><span class=p>,</span><span class=w> </span><span class=mi>36</span><span class=p>,</span><span class=w> </span><span class=mi>53</span><span class=p>,</span><span class=w> </span><span class=mi>51</span><span class=p>,</span><span class=w> </span><span class=mi>43</span><span class=p>,</span><span class=w> </span><span class=mi>22</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>45</span><span class=p>,</span><span class=w> </span><span class=mi>39</span><span class=p>,</span><span class=w> </span><span class=mi>33</span><span class=p>,</span><span class=w> </span><span class=mi>30</span><span class=p>,</span><span class=w> </span><span class=mi>24</span><span class=p>,</span><span class=w> </span><span class=mi>18</span><span class=p>,</span><span class=w> </span><span class=mi>12</span><span class=p>,</span><span class=w>  </span><span class=mi>5</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>63</span><span class=p>,</span><span class=w> </span><span class=mi>47</span><span class=p>,</span><span class=w> </span><span class=mi>56</span><span class=p>,</span><span class=w> </span><span class=mi>27</span><span class=p>,</span><span class=w> </span><span class=mi>60</span><span class=p>,</span><span class=w> </span><span class=mi>41</span><span class=p>,</span><span class=w> </span><span class=mi>37</span><span class=p>,</span><span class=w> </span><span class=mi>16</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>54</span><span class=p>,</span><span class=w> </span><span class=mi>35</span><span class=p>,</span><span class=w> </span><span class=mi>52</span><span class=p>,</span><span class=w> </span><span class=mi>21</span><span class=p>,</span><span class=w> </span><span class=mi>44</span><span class=p>,</span><span class=w> </span><span class=mi>32</span><span class=p>,</span><span class=w> </span><span class=mi>23</span><span class=p>,</span><span class=w> </span><span class=mi>11</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>46</span><span class=p>,</span><span class=w> </span><span class=mi>26</span><span class=p>,</span><span class=w> </span><span class=mi>40</span><span class=p>,</span><span class=w> </span><span class=mi>15</span><span class=p>,</span><span class=w> </span><span class=mi>34</span><span class=p>,</span><span class=w> </span><span class=mi>20</span><span class=p>,</span><span class=w> </span><span class=mi>31</span><span class=p>,</span><span class=w> </span><span class=mi>10</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=mi>25</span><span class=p>,</span><span class=w> </span><span class=mi>14</span><span class=p>,</span><span class=w> </span><span class=mi>19</span><span class=p>,</span><span class=w>  </span><span class=mi>9</span><span class=p>,</span><span class=w> </span><span class=mi>13</span><span class=p>,</span><span class=w>  </span><span class=mi>8</span><span class=p>,</span><span class=w>  </span><span class=mi>7</span><span class=p>,</span><span class=w>  </span><span class=mi>6</span><span class=w>
</span><span class=w>    </span><span class=p>];</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>INDEX64</span><span class=p>[(((</span><span class=n>x</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>.</span><span class=n>wrapping_neg</span><span class=p>()).</span><span class=n>wrapping_mul</span><span class=p>(</span><span class=mh>0x03f79d71b4cb0a89</span><span class=p>))</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>58</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>usize</span><span class=p>]</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>criterion_group</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>,</span><span class=w> </span><span class=n>benchmark</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>criterion_main</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>);</span><span class=w>
</span></code></pre></td></tr></table></div></div><p>The output assembly is a bit more complex, but the general idea is the same as for previous examples. You can say only by looking at this, that there are a lot of instructions, which will for sure consume processor time during computation.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-nasm data-lang=nasm><span class=nf>mov</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>neg</span> <span class=nb>rax</span>
<span class=nf>and</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>movabs</span> <span class=nb>rcx</span><span class=p>,</span> <span class=mi>285870213051386505</span>
<span class=nf>imul</span> <span class=nb>rcx</span><span class=p>,</span> <span class=nb>rax</span>
<span class=nf>shr</span> <span class=nb>rcx</span><span class=p>,</span> <span class=mi>58</span>
<span class=nf>lea</span> <span class=nb>rax</span><span class=p>,</span> <span class=p>[</span><span class=nv>rip</span> <span class=o>+</span> <span class=nv>anon.9e0e815cd4fdb58dcb37887dde8870f8.1020</span><span class=p>]</span>
<span class=nf>mov</span> <span class=nb>eax</span><span class=p>,</span> <span class=kt>dword</span> <span class=nv>ptr</span> <span class=p>[</span><span class=nb>rax</span> <span class=o>+</span> <span class=mi>4</span><span class=o>*</span><span class=nb>rcx</span><span class=p>]</span>
<span class=nf>ret</span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s look at the intrinsic function. The BMI1 equivalent of the manual counting zeros can be called by <code>trailing_zeros()</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>black_box</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_group</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>criterion_main</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>criterion</span>::<span class=n>Criterion</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>benchmark</span><span class=p>(</span><span class=n>criterion</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>Criterion</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>criterion</span><span class=p>.</span><span class=n>bench_function</span><span class=p>(</span><span class=s>&#34;bit_scan&#34;</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>bencher</span><span class=o>|</span><span class=w> </span><span class=n>bencher</span><span class=p>.</span><span class=n>iter</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>bit_scan</span><span class=p>(</span><span class=n>black_box</span><span class=p>(</span><span class=mi>45631345</span><span class=p>))));</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>bit_scan</span><span class=p>(</span><span class=n>x</span>: <span class=kt>u64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u64</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>x</span><span class=p>.</span><span class=n>trailing_zeros</span><span class=p>()</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>criterion_group</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>,</span><span class=w> </span><span class=n>benchmark</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>criterion_main</span><span class=o>!</span><span class=p>(</span><span class=n>benches</span><span class=p>);</span><span class=w>
</span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-nasm data-lang=nasm><span class=nf>tzcnt</span> <span class=nb>rax</span><span class=p>,</span> <span class=nb>rcx</span>
<span class=nf>ret</span></code></pre></td></tr></table></div></div><p>Benchmark results:</p><table><thead><tr><th></th><th align=left>Lower bound</th><th align=left>Estimate</th><th align=left>Upper bound</th></tr></thead><tbody><tr><td>Manual</td><td align=left>532.50 ps</td><td align=left><strong>533.43 ps</strong></td><td align=left>534.23 ps</td></tr><tr><td>BMI1</td><td align=left>330.40 ps</td><td align=left><strong>331.52 ps</strong></td><td align=left>332.93 ps</td></tr></tbody></table><h2 id=comparison>Comparison</h2><p>All benchmark results have been compiled in the following table. It clearly suggests that using <code>blsi</code> and <code>blsr</code> instructions didn&rsquo;t bring any noticeable performance gain - manual calculation was fast enough. Using <code>tzcnt</code> was much more successful since De Bruijn multiplication involved much more assembly that could be replaced by just one instruction.</p><table><thead><tr><th></th><th align=left>Estimate (Manual)</th><th align=left>Estimate (BMI1)</th><th align=left>Difference</th></tr></thead><tbody><tr><td>BLSI</td><td align=left>356.69</td><td align=left>356.97</td><td align=left><strong>0,0%</strong></td></tr><tr><td>BLSR</td><td align=left>357.31 ps</td><td align=left>357.58 ps</td><td align=left><strong>0,0%</strong></td></tr><tr><td>TZCNT</td><td align=left>533.43 ps</td><td align=left>331.52 ps</td><td align=left><strong>62,1%</strong></td></tr></tbody></table><h2 id=a-few-words-about-c>A few words about C#</h2><p>Until recently, all responsibility for generating machine code was on the JIT (Just-in-time). It means you couldn&rsquo;t tell the compiler that you want to use some specific instruction, eg. <a href=https://www.felixcloutier.com/x86/BLSI>BLSI</a>. But according to the <a href=https://devblogs.microsoft.com/dotnet/hardware-intrinsics-in-net-core/>recent news</a>, .NET Core 3 adds an amazing feature that allows using intrinsic functions directly in the C# code. You can find them in the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.intrinsics.x86?view=netcore-3.1">System.Runtime.Intrinsics.X86</a> namespace - don&rsquo;t be suggested by the &ldquo;X86&rdquo; prefix, there are also versions for 64-bit functions but for some reason, they are inside X86 namespace.</p><ul><li><strong>BLSI</strong> - <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.intrinsics.x86.bmi1.x64.extractlowestsetbit?view=netcore-3.1">System.Runtime.Intrinsics.X86.Bmi1.X64.ExtractLowestSetBit</a></li><li><strong>BLSR</strong> - <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.intrinsics.x86.bmi1.x64.resetlowestsetbit?view=netcore-3.1">System.Runtime.Intrinsics.X86.Bmi1.X64.ResetLowestSetBit</a></li><li><strong>TZCNT</strong> - <a href="https://docs.microsoft.com/en-us/dotnet/api/system.numerics.bitoperations.trailingzerocount?view=netcore-3.1">System.Numerics.BitOperations.TrailingZeroCount</a></li></ul><p>I made a good use of them while developing <a href=https://github.com/Tearth/Cosette>Cosette</a>, example can be found on the project repository in <a href=https://github.com/Tearth/Cosette/blob/master/Cosette/Engine/Common/BitOperations.cs>BitOperations.cs</a>. Calls to <code>X.IsSupported</code> do not have any additional overhead, since JIT correctly understands the platform on which a program runs on, so the unnecessary parts of the functions are cut off.</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/.net/ rel=tag>.NET</a></li><li class=tags__item><a class="tags__link btn" href=/tags/rust/ rel=tag>Rust</a></li><li class=tags__item><a class="tags__link btn" href=/tags/assembly/ rel=tag>Assembly</a></li><li class=tags__item><a class="tags__link btn" href=/tags/bmi/ rel=tag>BMI</a></li></ul></div></footer></article></main><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="Tearth avatar" src=https://github.com/Tearth.png class=avatar height=90 width=90></figure><div class=authorbox__header><span class=authorbox__name>About Tearth</span></div><div class=authorbox__description>C# programmer. After hours I enjoy writing chess engines, reading about history, space exploration and playing simulators or strategy games. I miss space shuttles.</div></div><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/posts/inanis-1-2-0-released/ rel=prev><span class=pager__subtitle>Â«&#8201;Previous</span><p class=pager__title>Inanis 1.2.0 released</p></a></div></nav></div><aside class=sidebar><div class="widget-categories widget"><h4 class=widget__title>Bitboard viewer</h4><div class=widget__content><a href=https://tearth.dev/bitboard-viewer/ alt="Bitboard viewer">https://tearth.dev/bitboard-viewer/</a></div></div><div class="widget-categories widget"><h4 class=widget__title>Chess engines</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Inanis><span class=project-title>Inanis</span> - the strongest one, under development</a><div class=project-details><b>Elo: 2850</b>, Language: Rust, SLOC: 10000</div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=LinkedIn rel="noopener noreferrer" href=https://lichess.org/@/InanisBot target=_blank><span>Play with Inanis on lichess.org</span></a></div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Cosette><span class=project-title>Cosette</span> - one of the best .NET engines</a><div class=project-details><b>Elo: 2500</b>, Language: C#, SLOC: 12000</div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=LinkedIn rel="noopener noreferrer" href=https://lichess.org/@/CosetteBot target=_blank><span>Play with Cosette on lichess.org</span></a></div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Proxima-b-2.0><span class=project-title>Proxima b 2.0</span> - made as part of BSc Thesis</a><div class=project-details><b>Elo: 1600</b>, Language: C#, SLOC: 10000</div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Proxima-b><span class=project-title>Proxima b 1.0</span> - the weakest and simplest one</a><div class=project-details><b>Elo: 1000</b>, Language: C++, SLOC: 4000</div></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Other projects</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=https://github.com/skni-kod/MicrOS><span class=project-title>MicrOS</span> - 32-bit operating system</a><div class=project-details>Language: C, Assembly. SLOC: 40000</div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Lemao><span class=project-title>Lemao</span> - game engine made from scratch</a><div class=project-details>Language: Rust. SLOC: 15000</div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Capybara><span class=project-title>Capybara</span> - another game engine</a><div class=project-details>Language: Rust. SLOC: 15000</div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/DotNet6502><span class=project-title>DotNet6502</span> - modular MOS 6502 emulator</a><div class=project-details>Language: C#. SLOC: 6000</div></li><li class=widget__item><a class=widget__link href=https://github.com/Tearth/Oddity><span class=project-title>Oddity</span> - unofficial SpaceX API wrapper</a><div class=project-details>Language: C#. SLOC: 3000</div></li></ul><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=LinkedIn rel="noopener noreferrer" href="https://github.com/Tearth?tab=repositories" target=_blank><span>Full list of repositories</span></a></div></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/categories/.net-internals/>.NET internals (6)</a></li><li class=widget__item><a class=widget__link href=/categories/chess-engines/>Chess engines (8)</a></li><li class=widget__item><a class=widget__link href=/categories/performance-comparisons/>Performance comparisons (4)</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/.net/ title=.NET>.NET (9)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/assembly/ title=Assembly>Assembly (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/bmi/ title=BMI>BMI (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/chess/ title=Chess>Chess (8)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/clr/ title=CLR>CLR (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/gethashcode/ title=GetHashCode>GetHashCode (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/inanis/ title=Inanis>Inanis (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/releases/ title=Releases>Releases (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/rust/ title=Rust>Rust (1)</a></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/Tearth target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg><span>GitHub</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/TearthDev target=_blank><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6.0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg><span>Twitter</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Lichess rel="noopener noreferrer" href=https://lichess.org/@/Tearth target=_blank><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="widget-social__link-icon icon icon-lichess" width="24" height="24" viewBox="2 3 21 21"><g id="surface1"><path style="fill-rule:evenodd;fill:#fff;fill-opacity:1;stroke-width:0" d="M22.001953 9.997559C32.497559 11.000977 38.503418 18.00293 37.998047 39.001465H15C15 30 24.997559 32.497559 22.998047 18.00293" transform="matrix(0.533333,0,0,0.533333,0,0)"/><path style="fill-rule:evenodd;fill:#fff;fill-opacity:1;stroke-width:0" d="M24.001465 18.00293C24.382324 20.910645 18.449707 25.371094 16.003418 26.99707 13.000488 28.996582 13.183594 31.340332 11.000977 31.003418 9.960938 30.058594 12.407227 27.956543 11.000977 28.000488 9.997559 28.000488 11.191406 29.230957 9.997559 30 9.001465 30 5.998535 31.003418 5.998535 26.000977 5.998535 24.001465 11.99707 13.996582 11.99707 13.996582S13.886719 12.099609 13.996582 10.50293C13.271484 9.506836 13.498535 8.503418 13.498535 7.5 14.501953 6.496582 16.501465 9.997559 16.501465 9.997559H18.500977S19.277344 8.005371 20.998535 7.001953L22.001953 9.997559" transform="matrix(0.533333,0,0,0.533333,0,0)"/><path style="fill-rule:evenodd;fill:#000;fill-opacity:1;stroke-width:0" d="M9.499512 25.50293C9.499512 25.773926 9.279785 26.000977 9.001465 26.000977 8.723145 26.000977 8.503418 25.773926 8.503418 25.50293 8.503418 25.224609 8.723145 24.997559 9.001465 24.997559 9.279785 24.997559 9.499512 25.224609 9.499512 25.50293zm0 0" transform="matrix(0.533333,0,0,0.533333,0,0)"/><path style="fill-rule:evenodd;fill:#000;fill-opacity:1;stroke-width:0" d="M14.999472 15.496922C14.996821 16.32729 14.774506 16.996929 14.499265 17.003609 14.226704 17.000284 13.999306 16.328111 14.001958 15.497742 13.998266 14.671036 14.22058 14.001397 14.499484 14.00106 14.778388 14.000723 14.995781 14.670215 14.999472 15.496922zm0 0" transform="matrix(0.461867,0.266667,-0.266667,0.461867,5.1696,-2.758933)"/></g></svg><span>Lichess</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Email href=mailto:tearthdev@gmail.com><svg class="widget-social__link-icon icon icon-mail" width="24" height="24" viewBox="0 0 416 288"><path d="m0 16v256 16h16 384 16v-16V16 0h-16H16 0zm347 16-139 92.5L69 32zM199 157.5l9 5.5 9-5.5L384 46v210H32V46z"/></svg><span>E-Mail</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 Tearth.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme, hosted on <a href=https://pages.github.com/ rel="nofollow noopener" target=_blank>pages.github.com</a>.</span></div></div></footer></div></body></html>